import{g as e}from"./index-B1MHyEgd.js";function t(e,t){return t.forEach(function(t){t&&"string"!=typeof t&&!Array.isArray(t)&&Object.keys(t).forEach(function(r){if("default"!==r&&!(r in e)){var s=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(e,r,s.get?s:{enumerable:!0,get:function(){return t[r]}})}})}),Object.freeze(e)}var r,s={exports:{}};var o,n=r?s.exports:(r=1,o="undefined"==typeof window?s.exports:window,s.exports=(e=>(()=>{var t,r={944:t=>{t.exports=e}},s={};function o(e){var t=s[e];if(void 0!==t)return t.exports;var n=s[e]={exports:{}};return r[e](n,n.exports,o),n.exports}o.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return o.d(t,{a:t}),t},o.d=(e,t)=>{for(var r in t)o.o(t,r)&&!o.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var n={};o.d(n,{default:()=>Pt});var i=o(944),l=o.n(i);let{addEvent:a,fireEvent:u,merge:h}=l();class m{benchmark(e,t){let r=[],s=this,o=()=>{s.modifyTable(e),s.emit({type:"afterBenchmarkIteration"})},{iterations:n}=h({iterations:1},t);s.on("afterBenchmarkIteration",()=>{r.length!==n?o():s.emit({type:"afterBenchmark",results:r})});let i={startTime:0,endTime:0};return s.on("modify",()=>{i.startTime=window.performance.now()}),s.on("afterModify",()=>{i.endTime=window.performance.now(),r.push(i.endTime-i.startTime)}),o(),r}emit(e){u(this,e.type,e)}modify(e,t){let r=this;return new Promise((s,o)=>{e.modified===e&&(e.modified=e.clone(!1,t));try{s(r.modifyTable(e,t))}catch(s){r.emit({type:"error",detail:t,table:e}),o(s instanceof Error?s:Error(""+s))}})}modifyCell(e,t,r,s,o){return this.modifyTable(e)}modifyColumns(e,t,r,s){return this.modifyTable(e)}modifyRows(e,t,r,s){return this.modifyTable(e)}on(e,t){return a(this,e,t)}}!function(e){e.types={},e.registerType=function(t,r){return!!t&&!e.types[t]&&!!(e.types[t]=r)}}(m||(m={}));let f=m;!function(e){e.setLength=function(e,t,r){return Array.isArray(e)?(e.length=t,e):e[r?"subarray":"slice"](0,t)},e.splice=function(e,t,r,s,o=[]){if(Array.isArray(e))return Array.isArray(o)||(o=Array.from(o)),{removed:e.splice(t,r,...o),array:e};let n=Object.getPrototypeOf(e).constructor,i=e[s?"subarray":"slice"](t,t+r),l=new n(e.length-r+o.length);return l.set(e.subarray(0,t),0),l.set(o,t),l.set(e.subarray(t+r),t+o.length),{removed:i,array:l}}}(t||(t={}));let d=t,{setLength:c,splice:p}=d,{fireEvent:g,objectEach:y,uniqueKey:b}=l(),w=class{constructor(e={}){this.autoId=!e.id,this.columns={},this.id=e.id||b(),this.modified=this,this.rowCount=0,this.versionTag=b();let t=0;y(e.columns||{},(e,r)=>{this.columns[r]=e.slice(),t=Math.max(t,e.length)}),this.applyRowCount(t)}applyRowCount(e){this.rowCount=e,y(this.columns,(t,r)=>{t.length!==e&&(this.columns[r]=c(t,e))})}deleteRows(e,t=1){if(t>0&&e<this.rowCount){let r=0;y(this.columns,(s,o)=>{this.columns[o]=p(s,e,t).array,r=s.length}),this.rowCount=r}g(this,"afterDeleteRows",{rowIndex:e,rowCount:t}),this.versionTag=b()}getColumn(e,t){return this.columns[e]}getColumns(e,t){return(e||Object.keys(this.columns)).reduce((e,t)=>(e[t]=this.columns[t],e),{})}getRow(e,t){return(t||Object.keys(this.columns)).map(t=>this.columns[t]?.[e])}setColumn(e,t=[],r=0,s){this.setColumns({[e]:t},r,s)}setColumns(e,t,r){let s=this.rowCount;y(e,(e,t)=>{this.columns[t]=e.slice(),s=e.length}),this.applyRowCount(s),r?.silent||(g(this,"afterSetColumns"),this.versionTag=b())}setRow(e,t=this.rowCount,r,s){let{columns:o}=this,n=r?this.rowCount+1:t+1;y(e,(e,i)=>{let l=o[i]||!1!==s?.addColumns&&Array(n);l&&(r?l=p(l,t,0,!0,[e]).array:l[t]=e,o[i]=l)}),n>this.rowCount&&this.applyRowCount(n),s?.silent||(g(this,"afterSetRows"),this.versionTag=b())}},{addEvent:C,defined:R,extend:N,fireEvent:T,isNumber:v,uniqueKey:O}=l();class A extends w{static isNull(e){if(e===A.NULL)return!0;if(e instanceof Array){if(!e.length)return!1;for(let t=0,r=e.length;t<r;++t)if(null!==e[t])return!1}else{let t=Object.keys(e);if(!t.length)return!1;for(let r=0,s=t.length;r<s;++r)if(null!==e[t[r]])return!1}return!0}constructor(e={}){super(e),this.modified=this}clone(e,t){let r={};this.emit({type:"cloneTable",detail:t}),e||(r.columns=this.columns),this.autoId||(r.id=this.id);let s=new A(r);return e||(s.versionTag=this.versionTag,s.originalRowIndexes=this.originalRowIndexes,s.localRowIndexes=this.localRowIndexes),this.emit({type:"afterCloneTable",detail:t,tableClone:s}),s}deleteColumns(e,t){let r=this.columns,s={},o={},n=this.modifier,i=this.rowCount;if((e=e||Object.keys(r)).length){this.emit({type:"deleteColumns",columnNames:e,detail:t});for(let t,n,l=0,a=e.length;l<a;++l)(t=r[n=e[l]])&&(s[n]=t,o[n]=Array(i)),delete r[n];return Object.keys(r).length||(this.rowCount=0,this.deleteRowIndexReferences()),n&&n.modifyColumns(this,o,0,t),this.emit({type:"afterDeleteColumns",columns:s,columnNames:e,detail:t}),s}}deleteRowIndexReferences(){delete this.originalRowIndexes,delete this.localRowIndexes}deleteRows(e,t=1,r){let s=[],o=[],n=this.modifier;if(this.emit({type:"deleteRows",detail:r,rowCount:t,rowIndex:e||0}),void 0===e&&(e=0,t=this.rowCount),t>0&&e<this.rowCount){let r=this.columns,n=Object.keys(r);for(let i,l,a,u=0,h=n.length;u<h;++u){i=r[a=n[u]];let m=d.splice(i,e,t);l=m.removed,r[a]=i=m.array,u||(this.rowCount=i.length);for(let e=0,t=l.length;e<t;++e)s[e]=s[e]||[],s[e][u]=l[e];o.push(Array(h))}}return n&&n.modifyRows(this,o,e||0,r),this.emit({type:"afterDeleteRows",detail:r,rowCount:t,rowIndex:e||0,rows:s}),s}emit(e){["afterDeleteColumns","afterDeleteRows","afterSetCell","afterSetColumns","afterSetRows"].includes(e.type)&&(this.versionTag=O()),T(this,e.type,e)}getCell(e,t){let r=this.columns[e];if(r)return r[t]}getCellAsBoolean(e,t){let r=this.columns[e];return!(!r||!r[t])}getCellAsNumber(e,t,r){let s=this.columns[e],o=s&&s[t];switch(typeof o){case"boolean":return+!!o;case"number":return isNaN(o)&&!r?null:o}return isNaN(o=parseFloat(`${o??""}`))&&!r?null:o}getCellAsString(e,t){let r=this.columns[e];return`${r&&r[t]}`}getColumn(e,t){return this.getColumns([e],t)[e]}getColumnAsNumbers(e,t){let r=this.columns[e],s=[];if(r){let o=r.length;if(t)for(let t=0;t<o;++t)s.push(this.getCellAsNumber(e,t,!0));else{for(let e,t=0;t<o;++t){if("number"==typeof(e=r[t]))return r.slice();if(null!=e)break}for(let t=0;t<o;++t)s.push(this.getCellAsNumber(e,t))}}return s}getColumnNames(){return Object.keys(this.columns)}getColumns(e,t,r){let s=this.columns,o={};for(let n,i,l=0,a=(e=e||Object.keys(s)).length;l<a;++l)(n=s[i=e[l]])&&(t?o[i]=n:r&&!Array.isArray(n)?o[i]=Array.from(n):o[i]=n.slice());return o}getLocalRowIndex(e){let{localRowIndexes:t}=this;return t?t[e]:e}getModifier(){return this.modifier}getOriginalRowIndex(e){let{originalRowIndexes:t}=this;return t?t[e]:e}getRow(e,t){return this.getRows(e,1,t)[0]}getRowCount(){return this.rowCount}getRowIndexBy(e,t,r){let s=this.columns[e];if(s){let e=-1;if((Array.isArray(s)||v(t))&&(e=s.indexOf(t,r)),-1!==e)return e}}getRowObject(e,t){return this.getRowObjects(e,1,t)[0]}getRowObjects(e=0,t=this.rowCount-e,r){let s=this.columns,o=Array(t);r=r||Object.keys(s);for(let n,i,l=e,a=0,u=Math.min(this.rowCount,e+t);l<u;++l,++a)for(let e of(i=o[a]={},r))n=s[e],i[e]=n?n[l]:void 0;return o}getRows(e=0,t=this.rowCount-e,r){let s=this.columns,o=Array(t);r=r||Object.keys(s);for(let n,i,l=e,a=0,u=Math.min(this.rowCount,e+t);l<u;++l,++a)for(let e of(i=o[a]=[],r))n=s[e],i.push(n?n[l]:void 0);return o}getVersionTag(){return this.versionTag}hasColumns(e){let t=this.columns;for(let r=0,s=e.length;r<s;++r)if(!t[e[r]])return!1;return!0}hasRowWith(e,t){let r=this.columns[e];return Array.isArray(r)?-1!==r.indexOf(t):!(!R(t)||!Number.isFinite(t))&&-1!==r.indexOf(+t)}on(e,t){return C(this,e,t)}renameColumn(e,t){let r=this.columns;return!!r[e]&&(e!==t&&(r[t]=r[e],delete r[e]),!0)}setCell(e,t,r,s){let o=this.columns,n=this.modifier,i=o[e];i&&i[t]===r||(this.emit({type:"setCell",cellValue:r,columnName:e,detail:s,rowIndex:t}),i||(i=o[e]=Array(this.rowCount)),t>=this.rowCount&&(this.rowCount=t+1),i[t]=r,n&&n.modifyCell(this,e,t,r),this.emit({type:"afterSetCell",cellValue:r,columnName:e,detail:s,rowIndex:t}))}setColumns(e,t,r,s){let o=this.columns,n=this.modifier,i=Object.keys(e),l=this.rowCount;if(this.emit({type:"setColumns",columns:e,columnNames:i,detail:r,rowIndex:t}),R(t)||s){for(let r,n,a,u,h=0,m=i.length;h<m;++h){r=e[a=i[h]],u=Object.getPrototypeOf((n=o[a])&&s?n:r).constructor,n?u===Array?Array.isArray(n)||(n=Array.from(n)):n.length<l&&(n=new u(l)).set(o[a]):n=new u(l),o[a]=n;for(let e=t||0,s=r.length;e<s;++e)n[e]=r[e];l=Math.max(l,r.length)}this.applyRowCount(l)}else super.setColumns(e,t,N(r,{silent:!0}));n&&n.modifyColumns(this,e,t||0),this.emit({type:"afterSetColumns",columns:e,columnNames:i,detail:r,rowIndex:t})}setModifier(e,t){let r=this;return r.emit({type:"setModifier",detail:t,modifier:e,modified:r.modified}),r.modified=r,r.modifier=e,(e?e.modify(r):Promise.resolve(r)).then(r=>(r.emit({type:"afterSetModifier",detail:t,modifier:e,modified:r.modified}),r)).catch(t=>{throw r.emit({type:"setModifierError",error:t,modifier:e,modified:r.modified}),t})}setOriginalRowIndexes(e,t=!1){if(this.originalRowIndexes=e,t)return;let r=this.localRowIndexes=[];for(let t,s=0,o=e.length;s<o;++s)R(t=e[s])&&(r[t]=s)}setRow(e,t,r,s){this.setRows([e],t,r,s)}setRows(e,t=this.rowCount,r,s){let o=this.columns,n=Object.keys(o),i=this.modifier,l=e.length;this.emit({type:"setRows",detail:s,rowCount:l,rowIndex:t,rows:e});for(let s,i=0,a=t;i<l;++i,++a)if((s=e[i])===A.NULL)for(let e=0,t=n.length;e<t;++e){let t=o[n[e]];r?o[n[e]]=d.splice(t,a,0,!0,[null]).array:t[a]=null}else if(s instanceof Array)for(let e=0,t=n.length;e<t;++e)o[n[e]][a]=s[e];else super.setRow(s,a,void 0,{silent:!0});let a=r?l+e.length:t+l;if(a>this.rowCount){this.rowCount=a;for(let e=0,t=n.length;e<t;++e){let t=n[e];o[t]=d.setLength(o[t],a)}}i&&i.modifyRows(this,e,t),this.emit({type:"afterSetRows",detail:s,rowCount:l,rowIndex:t,rows:e})}}A.NULL={},A.version="1.0.0";let{addEvent:x,fireEvent:F,merge:E,pick:I}=l();class M{constructor(e={},t=[]){this.dataTables={},this.loaded=!1,this.metadata=e.metadata||{columns:{}};let r=0;if(t?.length>0)for(let e=0,s=t.length;e<s;++e){let s=t[e],o=s?.key;this.dataTables[o??r]=new A(s),!o&&r++}else this.dataTables[0]=new A(e.dataTable)}get polling(){return!!this._polling}get table(){return this.getTable()}describeColumn(e,t){let r=this.metadata.columns;r[e]=E(r[e]||{},t)}describeColumns(e){let t,r=Object.keys(e);for(;"string"==typeof(t=r.pop());)this.describeColumn(t,e[t])}emit(e){F(this,e.type,e)}getColumnOrder(e){let t=this.metadata.columns,r=Object.keys(t||{});if(r.length)return r.sort((e,r)=>I(t[e].index,0)-I(t[r].index,0))}getTable(e){return e?this.dataTables[e]:Object.values(this.dataTables)[0]}getSortedColumns(e){return this.table.getColumns(this.getColumnOrder(e))}load(){return F(this,"afterLoad",{table:this.table}),Promise.resolve(this)}on(e,t){return x(this,e,t)}save(){return F(this,"saveError",{table:this.table}),Promise.reject(Error("Not implemented"))}setColumnOrder(e){for(let t=0,r=e.length;t<r;++t)this.describeColumn(e[t],{index:t})}async setModifierOptions(e,t){for(let[r,s]of Object.entries(this.dataTables)){let o=t?.find(e=>e.key===r),n=E(o?.dataModifier,e),i=n&&f.types[n.type];await s.setModifier(i?new i(n):void 0)}return this}startPolling(e=1e3){let t=this,r=t.dataTables;this.pollingController=new AbortController,window.clearTimeout(t._polling),t._polling=window.setTimeout(()=>t.load().catch(e=>t.emit({type:"loadError",error:e,tables:r})).then(()=>{t._polling&&t.startPolling(e)}),e)}stopPolling(){this.polling&&(this?.pollingController?.abort(),window.clearTimeout(this._polling),delete this._polling)}whatIs(e){return this.metadata.columns[e]}initConverters(e,t,r){let s=0;for(let[o,n]of Object.entries(this.dataTables)){let i=t(o,n);r(i,e),n.deleteColumns(),n.setColumns(i.getTable().getColumns()),0===s&&(this.converter=i),s++}}}!function(e){e.types={},e.registerType=function(t,r){return!!t&&!e.types[t]&&!!(e.types[t]=r)}}(M||(M={}));let P=M,{addEvent:D,fireEvent:j,isNumber:L,merge:S}=l();class k{constructor(e){this.dateFormats={"YYYY/mm/dd":{regex:/^(\d{4})([\-\.\/])(\d{1,2})\2(\d{1,2})$/,parser:function(e){return e?Date.UTC(+e[1],e[3]-1,+e[4]):NaN}},"dd/mm/YYYY":{regex:/^(\d{1,2})([\-\.\/])(\d{1,2})\2(\d{4})$/,parser:function(e){return e?Date.UTC(+e[4],e[3]-1,+e[1]):NaN},alternative:"mm/dd/YYYY"},"mm/dd/YYYY":{regex:/^(\d{1,2})([\-\.\/])(\d{1,2})\2(\d{4})$/,parser:function(e){return e?Date.UTC(+e[4],e[1]-1,+e[3]):NaN}},"dd/mm/YY":{regex:/^(\d{1,2})([\-\.\/])(\d{1,2})\2(\d{2})$/,parser:function(e){let t=new Date;if(!e)return NaN;let r=+e[4];return r>t.getFullYear()-2e3?r+=1900:r+=2e3,Date.UTC(r,e[3]-1,+e[1])},alternative:"mm/dd/YY"},"mm/dd/YY":{regex:/^(\d{1,2})([\-\.\/])(\d{1,2})\2(\d{2})$/,parser:function(e){return e?Date.UTC(+e[4]+2e3,e[1]-1,+e[3]):NaN}}};let t=S(k.defaultOptions,e),r=t.decimalPoint;("."===r||","===r)&&(r="."===r?"\\.":",",this.decimalRegExp=RegExp("^(-?[0-9]+)"+r+"([0-9]+)$")),this.options=t}asBoolean(e){return"boolean"==typeof e?e:"string"==typeof e?""!==e&&"0"!==e&&"false"!==e:!!this.asNumber(e)}asDate(e){let t;if("string"==typeof e)t=this.parseDate(e);else if("number"==typeof e)t=e;else{if(e instanceof Date)return e;t=this.parseDate(this.asString(e))}return new Date(t)}asGuessedType(e){return{number:this.asNumber,Date:this.asDate,string:this.asString}[this.guessType(e)].call(this,e)}asNumber(e){if("number"==typeof e)return e;if("boolean"==typeof e)return+!!e;if("string"==typeof e){let t=this.decimalRegExp;if(e.indexOf(" ")>-1&&(e=e.replace(/\s+/g,"")),t){if(!t.test(e))return NaN;e=e.replace(t,"$1.$2")}return parseFloat(e)}return e instanceof Date?e.getDate():e?e.getRowCount():NaN}asString(e){return""+e}deduceDateFormat(e,t,r){let s,o,n,i=[],l=[],a="YYYY/mm/dd",u=[],h=0,m=!1;for((!t||t>e.length)&&(t=e.length);h<t;h++)if(void 0!==e[h]&&e[h]&&e[h].length)for(n=0,s=e[h].trim().replace(/[\-\.\/]/g," ").split(" "),u=["","",""];n<s.length;n++)n<u.length&&(o=parseInt(s[n],10))&&(l[n]=!l[n]||l[n]<o?o:l[n],void 0!==i[n]?i[n]!==o&&(i[n]=!1):i[n]=o,o>31?u[n]=o<100?"YY":"YYYY":o>12&&o<=31?(u[n]="dd",m=!0):u[n].length||(u[n]="mm"));if(m){for(n=0;n<i.length;n++)!1!==i[n]?l[n]>12&&"YY"!==u[n]&&"YYYY"!==u[n]&&(u[n]="YY"):l[n]>12&&"mm"===u[n]&&(u[n]="dd");3===u.length&&"dd"===u[1]&&"dd"===u[2]&&(u[2]="YY"),a=u.join("/")}return r&&(this.options.dateFormat=a),a}emit(e){j(this,e.type,e)}export(e,t){throw this.emit({type:"exportError",columns:[],headers:[]}),Error("Not implemented")}getTable(){throw Error("Not implemented")}guessType(e){let t="string";if("string"==typeof e){let r=this.trim(`${e}`),s=this.decimalRegExp,o=this.trim(r,!0);s&&(o=s.test(o)?o.replace(s,"$1.$2"):"");let n=parseFloat(o);+o===n?e=n:t=L(this.parseDate(e))?"Date":"string"}return"number"==typeof e&&(t=e>31536e6?"Date":"number"),t}on(e,t){return D(this,e,t)}parse(e){throw this.emit({type:"parseError",columns:[],headers:[]}),Error("Not implemented")}parseDate(e,t){let r,s,o,n=this.options,i=t||n.dateFormat,l=NaN;if(n.parseDate)l=n.parseDate(e);else{if(i)(s=this.dateFormats[i])||(s=this.dateFormats["YYYY/mm/dd"]),(o=e.match(s.regex))&&(l=s.parser(o));else for(r in this.dateFormats)if(s=this.dateFormats[r],o=e.match(s.regex)){i=r,l=s.parser(o);break}!o&&("object"==typeof(o=Date.parse(e))&&null!==o&&o.getTime?l=o.getTime()-6e4*o.getTimezoneOffset():L(o)&&(l=o-6e4*new Date(o).getTimezoneOffset(),-1===e.indexOf("2001")&&2001===new Date(l).getFullYear()&&(l=NaN)))}return l}trim(e,t){return"string"==typeof e&&(e=e.replace(/^\s+|\s+$/g,""),t&&/^[\d\s]+$/.test(e)&&(e=e.replace(/\s/g,""))),e}}k.defaultOptions={dateFormat:"",alternativeFormat:"",startColumn:0,endColumn:Number.MAX_VALUE,startRow:0,endRow:Number.MAX_VALUE,firstRowAsNames:!0,switchRowsAndColumns:!1},function(e){e.types={},e.registerType=function(t,r){return!!t&&!e.types[t]&&!!(e.types[t]=r)},e.getTableFromColumns=function(e=[],t=[]){let r=new A;for(let s=0,o=Math.max(t.length,e.length);s<o;++s)r.setColumn(t[s]||`${s}`,e[s]);return r}}(k||(k={}));let Y=k;class V{constructor(e={}){this.emittingRegister=[],this.listenerMap={},this.stateMap=e}addListener(e,t,r){let s=this.listenerMap[e]=this.listenerMap[e]||{};return(s[t]=s[t]||[]).push(r),this}buildEmittingTag(e){return("position"===e.cursor.type?[e.table.id,e.cursor.column,e.cursor.row,e.cursor.state,e.cursor.type]:[e.table.id,e.cursor.columns,e.cursor.firstRow,e.cursor.lastRow,e.cursor.state,e.cursor.type]).join("\0")}emitCursor(e,t,r,s){let o=e.id,n=t.state,i=this.listenerMap[o]&&this.listenerMap[o][n];if(i){let n=this.stateMap[o]=this.stateMap[o]??{},l=n[t.state]||[];s&&(l.length||(n[t.state]=l),-1===V.getIndex(t,l)&&l.push(t));let a={cursor:t,cursors:l,table:e};r&&(a.event=r);let u=this.emittingRegister,h=this.buildEmittingTag(a);if(u.indexOf(h)>=0)return this;try{this.emittingRegister.push(h);for(let e=0,t=i.length;e<t;++e)i[e].call(this,a)}finally{let e=this.emittingRegister.indexOf(h);e>=0&&this.emittingRegister.splice(e,1)}}return this}remitCursor(e,t){let r=this.stateMap[e]&&this.stateMap[e][t.state];if(r){let e=V.getIndex(t,r);e>=0&&r.splice(e,1)}return this}removeListener(e,t,r){let s=this.listenerMap[e]&&this.listenerMap[e][t];if(s){let e=s.indexOf(r);e>=0&&s.splice(e,1)}return this}}V.version="1.0.0",function(e){function t(e,t){if("range"===e.type)return e;let r={type:"range",firstRow:e.row??(t&&t.firstRow)??0,lastRow:e.row??(t&&t.lastRow)??Number.MAX_VALUE,state:e.state};return void 0!==e.column&&(r.columns=[e.column]),r}e.getIndex=function(e,t){if("position"===e.type){for(let r,s=0,o=t.length;s<o;++s)if("position"===(r=t[s]).type&&r.state===e.state&&r.column===e.column&&r.row===e.row)return s}else{let r=JSON.stringify(e.columns);for(let s,o=0,n=t.length;o<n;++o)if("range"===(s=t[o]).type&&s.state===e.state&&s.firstRow===e.firstRow&&s.lastRow===e.lastRow&&JSON.stringify(s.columns)===r)return o}return-1},e.isEqual=function(e,t){return"position"===e.type&&"position"===t.type?e.column===t.column&&e.row===t.row&&e.state===t.state:"range"===e.type&&"range"===t.type&&e.firstRow===t.firstRow&&e.lastRow===t.lastRow&&JSON.stringify(e.columns)===JSON.stringify(t.columns)},e.isInRange=function(e,r){"position"===r.type&&(r=t(r)),"position"===e.type&&(e=t(e,r));let s=e.columns,o=r.columns;return e.firstRow>=r.firstRow&&e.lastRow<=r.lastRow&&(!s||!o||s.every(e=>o.indexOf(e)>=0))},e.toPositions=function(e){if("position"===e.type)return[e];let t=e.columns||[],r=[],s=e.state;for(let o=e.firstRow,n=e.lastRow;o<n;++o)if(t.length)for(let e=0,n=t.length;e<n;++e)r.push({type:"position",column:t[e],row:o,state:s});else r.push({type:"position",row:o,state:s});return r},e.toRange=t}(V||(V={}));let $=V,U={connectors:[]};class H{constructor(e=U){e.connectors=e.connectors||[],this.connectors={},this.options=e,this.waiting={}}emit(e){l().fireEvent(this,e.type,e)}getConnector(e){let t=this.connectors[e];if(t?.loaded)return Promise.resolve(t);let r=this.waiting[e];if(!r){r=this.waiting[e]=[];let t=this.getConnectorOptions(e);if(!t)throw Error(`Connector '${e}' not found.`);this.loadConnector(t).then(t=>{delete this.waiting[e];for(let e=0,s=r.length;e<s;++e)r[e][0](t)}).catch(t=>{delete this.waiting[e];for(let e=0,s=r.length;e<s;++e)r[e][1](t)})}return new Promise((e,t)=>{r.push([e,t])})}getConnectorIds(){let e=this.options.connectors,t=[];for(let r=0,s=e.length;r<s;++r)t.push(e[r].id);return t}getConnectorOptions(e){let t=this.options.connectors;for(let r=0,s=t.length;r<s;++r)if(t[r].id===e)return t[r]}getConnectorTable(e){return this.getConnector(e).then(e=>e.table)}isNewConnector(e){return!this.connectors[e]}loadConnector(e){return new Promise((t,r)=>{this.emit({type:"load",options:e});let s=P.types[e.type];if(!s)throw Error(`Connector type not found. (${e.type})`);let o=this.connectors[e.id]=new s(e.options,e.dataTables);o.load().then(({converter:r,dataTables:s})=>{o.dataTables=s,o.converter=r,o.loaded=!0,this.emit({type:"afterLoad",options:e}),t(o)}).catch(r)})}cancelPendingRequests(){let{connectors:e}=this;for(let t of Object.keys(e))e[t].stopPolling()}on(e,t){return l().addEvent(this,e,t)}setConnectorOptions(e){let t=this.options.connectors,r=this.connectors;this.emit({type:"setConnectorOptions",options:e});for(let r=0,s=t.length;r<s;++r)if(t[r].id===e.id){t.splice(r,1);break}r[e.id]&&(r[e.id].stopPolling(),delete r[e.id]),t.push(e),this.emit({type:"afterSetConnectorOptions",options:e})}}H.version="1.0.0";let{isString:_}=l(),B=/^(?:FALSE|TRUE)/,G=/^[+\-]?\d+(?:\.\d+)?(?:e[+\-]\d+)?/,K=/^[+\-]?\d+(?:,\d+)?(?:e[+\-]\d+)?/,Z=/^([A-Z][A-Z\d\.]*)\(/,J=/^(?:[+\-*\/^<=>]|<=|=>)/,X=/^(\$?[A-Z]+)(\$?\d+)\:(\$?[A-Z]+)(\$?\d+)/,q=/^R(\d*|\[\d+\])C(\d*|\[\d+\])\:R(\d*|\[\d+\])C(\d*|\[\d+\])/,z=/^(\$?[A-Z]+)(\$?\d+)(?![\:C])/,Q=/^R(\d*|\[\d+\])C(\d*|\[\d+\])(?!\:)/;function W(e){let t=0;for(let r,s=0,o=e.length,n=1;s<o;++s)if("("!==(r=e[s])){if(")"===r&&! --t)return e.substring(n,s)}else t||(n=s+1),++t;if(t>0){let e=Error("Incomplete parantheses.");throw e.name="FormulaParseError",e}return""}function ee(e){let t=-1;for(let r,s=0,o=e.length,n=!1;s<o;++s)if("\\"!==(r=e[s])){if(n)n=!1;else if('"'===r){if(!(t<0))return e.substring(t+1,s);t=s}}else n=!n;let r=Error("Incomplete string.");throw r.name="FormulaParseError",r}function te(e,t){let r;if(r=e.match(q)){let e=""===r[2]||"["===r[2][0],t=""===r[1]||"["===r[1][0],s=""===r[4]||"["===r[4][0],o=""===r[3]||"["===r[3][0],n={type:"range",beginColumn:e?parseInt(r[2].substring(1,-1)||"0",10):parseInt(r[2],10)-1,beginRow:t?parseInt(r[1].substring(1,-1)||"0",10):parseInt(r[1],10)-1,endColumn:s?parseInt(r[4].substring(1,-1)||"0",10):parseInt(r[4],10)-1,endRow:o?parseInt(r[3].substring(1,-1)||"0",10):parseInt(r[3],10)-1};return e&&(n.beginColumnRelative=!0),t&&(n.beginRowRelative=!0),s&&(n.endColumnRelative=!0),o&&(n.endRowRelative=!0),n}if(r=e.match(X)){let e="$"!==r[1][0],t="$"!==r[2][0],s="$"!==r[3][0],o="$"!==r[4][0],n={type:"range",beginColumn:oe(e?r[1]:r[1].substring(1))-1,beginRow:parseInt(t?r[2]:r[2].substring(1),10)-1,endColumn:oe(s?r[3]:r[3].substring(1))-1,endRow:parseInt(o?r[4]:r[4].substring(1),10)-1};return e&&(n.beginColumnRelative=!0),t&&(n.beginRowRelative=!0),s&&(n.endColumnRelative=!0),o&&(n.endRowRelative=!0),n}let s=se(e,t);return 1===s.length&&"string"!=typeof s[0]?s[0]:s}function re(e){let t=e.length,r=e[t-2];return"-"===e[t-1]&&_(r)&&!!r.match(/\*|\/|\^/)}function se(e,t){let r,s=t?K:G,o=[],n=("="===e[0]?e.substring(1):e).trim();for(;n;){if(r=n.match(Q)){let e=""===r[2]||"["===r[2][0],t=""===r[1]||"["===r[1][0],s={type:"reference",column:e?parseInt(r[2].substring(1,-1)||"0",10):parseInt(r[2],10)-1,row:t?parseInt(r[1].substring(1,-1)||"0",10):parseInt(r[1],10)-1};e&&(s.columnRelative=!0),t&&(s.rowRelative=!0),re(o)&&(o.pop(),s.isNegative=!0),o.push(s),n=n.substring(r[0].length).trim();continue}if(r=n.match(z)){let e="$"!==r[1][0],t="$"!==r[2][0],s={type:"reference",column:oe(e?r[1]:r[1].substring(1))-1,row:parseInt(t?r[2]:r[2].substring(1),10)-1};e&&(s.columnRelative=!0),t&&(s.rowRelative=!0),re(o)&&(o.pop(),s.isNegative=!0),o.push(s),n=n.substring(r[0].length).trim();continue}if(r=n.match(J)){o.push(r[0]),n=n.substring(r[0].length).trim();continue}if(r=n.match(B)){o.push("TRUE"===r[0]),n=n.substring(r[0].length).trim();continue}if(r=n.match(s)){let e=parseFloat(r[0]);re(o)&&(o.pop(),e=-e),o.push(e),n=n.substring(r[0].length).trim();continue}if('"'===n[0]){let e=ee(n);o.push(e.substring(1,-1)),n=n.substring(e.length+2).trim();continue}if(r=n.match(Z)){let e=W(n=n.substring(r[1].length).trim());o.push({type:"function",name:r[1],args:function(e,t){let r=[],s=t?";":",",o=0,n="";for(let i,l=0,a=e.length;l<a;++l)if((i=e[l])===s&&!o&&n)r.push(te(n,t)),n="";else if('"'!==i||o||n)" "!==i&&(n+=i,"("===i?++o:")"===i&&--o);else{let t=ee(e.substring(l));r.push(t),l+=t.length+1}return!o&&n&&r.push(te(n,t)),r}(e,t)}),n=n.substring(e.length+2).trim();continue}if("("===n[0]){let e=W(n);if(e){o.push(se(e,t)),n=n.substring(e.length+2).trim();continue}}let i=e.length-n.length,l=Error("Unexpected character `"+e.substring(i,i+1)+"` at position "+(i+1)+". (`..."+e.substring(i-5,i+6)+"...`)");throw l.name="FormulaParseError",l}return o}function oe(e){let t=0;for(let r,s=0,o=e.length,n=e.length-1;s<o;++s)(r=e.charCodeAt(s))>=65&&r<=90&&(t+=(r-64)*Math.pow(26,n)),--n;return t}let ne={parseFormula:se},ie=["+","-","*","/","^","=","<","<=",">",">="],le={isFormula:function(e){return e instanceof Array},isFunction:function(e){return"object"==typeof e&&!(e instanceof Array)&&"function"===e.type},isOperator:function(e){return"string"==typeof e&&ie.indexOf(e)>=0},isRange:function(e){return"object"==typeof e&&!(e instanceof Array)&&"range"===e.type},isReference:function(e){return"object"==typeof e&&!(e instanceof Array)&&"reference"===e.type},isValue:function(e){return"boolean"==typeof e||"number"==typeof e||"string"==typeof e}},{isFormula:ae,isFunction:ue,isOperator:he,isRange:me,isReference:fe,isValue:de}=le,{defined:ce}=l(),pe=/ */,ge=Number.MAX_VALUE/1.000000000001,ye=Number.MAX_VALUE/1.000000000002,be=Number.MAX_VALUE,we={"^":3,"*":2,"/":2,"+":1,"-":1,"=":0,"<":0,"<=":0,">":0,">=":0},Ce={},Re=/^[A-Z][A-Z\.]*$/;function Ne(e){switch(typeof e){case"boolean":return e?be:ge;case"string":return ye;case"number":return e;default:return NaN}}function Te(e){return"string"==typeof e?e.toLowerCase().replace(pe,"\0"):e}function ve(e){switch(typeof e){case"boolean":return+!!e;case"string":return parseFloat(e.replace(",","."));case"number":return e;default:return NaN}}function Oe(e,t){return de(e)?e:me(e)?t&&Ae(e,t)||[]:ue(e)?Ie(e,t):Ee(ae(e)?e:[e],t)}function Ae(e,t){let r=t.getColumnNames().slice(e.beginColumn,e.endColumn+1),s=[];for(let o,n=0,i=r.length;n<i;++n){let i=t.getColumn(r[n],!0)||[];for(let l=e.beginRow,a=e.endRow+1;l<a;++l)"string"==typeof(o=i[l])&&"="===o[0]&&t!==t.modified&&(o=t.modified.getCell(r[n],l)),s.push(de(o)?o:NaN)}return s}function xe(e,t){let r=t.getColumnNames()[e.column];if(r){let s=t.getCell(r,e.row);if("string"==typeof s&&"="===s[0]&&t!==t.modified){let s=t.modified.getCell(r,e.row);return de(s)?s:NaN}if(de(s))return e.isNegative?-s:s}return NaN}function Fe(e,t){(e.length<2||t.length<1)&&e.push(NaN);let r=e.pop(),s=e.pop(),o=t.pop();ce(r)&&ce(s)&&ce(o)?e.push(function(e,t,r){let s;switch(e){case"=":return Te(t)===Te(r);case"<":return typeof t==typeof r?Te(t)<Te(r):Ne(t)<Ne(r);case"<=":return typeof t==typeof r?Te(t)<=Te(r):Ne(t)<=Ne(r);case">":return typeof t==typeof r?Te(t)>Te(r):Ne(t)>Ne(r);case">=":return typeof t==typeof r?Te(t)>=Te(r):Ne(t)>=Ne(r)}switch(t=ve(t),r=ve(r),e){case"+":s=t+r;break;case"-":s=t-r;break;case"*":s=t*r;break;case"/":s=t/r;break;case"^":s=Math.pow(t,r);break;default:return NaN}return s%1?Math.round(1e9*s)/1e9:s}(o,s,r)):e.push(NaN)}function Ee(e,t){let r=[],s=[],o=!0;for(let n=0,i=e.length;n<i;++n){let i,l=e[n];if(he(l))if(o&&"-"===l)r.push(0),s.push("-"),o=!0;else{for(;s.length&&we[s[s.length-1]]>=we[l];)Fe(r,s);s.push(l),o=!0}else{if(de(l))i=l;else if(fe(l))i=t?xe(l,t):NaN;else if(ue(l)){let e=Ie(l,t);i=de(e)?e:NaN}else ae(l)&&(i=Ee(l,t));if(void 0===i)return NaN;r.push(i),o=!1}}for(;s.length;)Fe(r,s);return 1!==r.length?NaN:r[0]}function Ie(e,t,r){let s=Ce[e.name];if(s)try{return s(e.args,t)}catch{return NaN}let o=Error(`Function "${e.name}" not found.`);throw o.name="FormulaProcessError",o}let Me={asNumber:ve,getArgumentValue:Oe,getArgumentsValues:function(e,t){let r=[];for(let s=0,o=e.length;s<o;++s)r.push(Oe(e[s],t));return r},getRangeValues:Ae,getReferenceValue:xe,processFormula:Ee,processorFunctions:Ce,registerProcessorFunction:function(e,t){return Re.test(e)&&!Ce[e]&&!!(Ce[e]=t)},translateReferences:function e(t,r=0,s=0){for(let o,n=0,i=t.length;n<i;++n)(o=t[n])instanceof Array?e(o,r,s):ue(o)?e(o.args,r,s):me(o)?(o.beginColumnRelative&&(o.beginColumn+=r),o.beginRowRelative&&(o.beginRow+=s),o.endColumnRelative&&(o.endColumn+=r),o.endRowRelative&&(o.endRow+=s)):fe(o)&&(o.columnRelative&&(o.column+=r),o.rowRelative&&(o.row+=s));return t}},{getArgumentValue:Pe}=Me;Me.registerProcessorFunction("ABS",function(e,t){let r=Pe(e[0],t);switch(typeof r){case"number":return Math.abs(r);case"object":{let e=[];for(let t,s=0,o=r.length;s<o;++s){if("number"!=typeof(t=r[s]))return NaN;e.push(Math.abs(t))}return e}default:return NaN}});let{getArgumentValue:De}=Me;Me.registerProcessorFunction("AND",function e(t,r){for(let s,o=0,n=t.length;o<n;++o)if(!(s=De(t[o],r))||"object"==typeof s&&!e(s,r))return!1;return!0});let{getArgumentsValues:je}=Me;Me.registerProcessorFunction("AVERAGE",function(e,t){let r=je(e,t),s=0,o=0;for(let e,t=0,n=r.length;t<n;++t)switch(typeof(e=r[t])){case"number":isNaN(e)||(++s,o+=e);break;case"object":for(let t,r=0,n=e.length;r<n;++r)"number"!=typeof(t=e[r])||isNaN(t)||(++s,o+=t)}return s?o/s:0});let{getArgumentValue:Le}=Me;Me.registerProcessorFunction("AVERAGEA",function(e,t){let r=0,s=0;for(let o,n=0,i=e.length;n<i;++n)switch(typeof(o=Le(e[n],t))){case"boolean":++r,s+=+!!o;continue;case"number":isNaN(o)||(++r,s+=o);continue;case"string":++r;continue;default:for(let e,t=0,n=o.length;t<n;++t)switch(typeof(e=o[t])){case"boolean":++r,s+=+!!e;continue;case"number":isNaN(e)||(++r,s+=e);continue;case"string":++r;continue}continue}return r?s/r:0}),Me.registerProcessorFunction("COUNT",function e(t,r){let s=Me.getArgumentsValues(t,r),o=0;for(let t,n=0,i=s.length;n<i;++n)switch(typeof(t=s[n])){case"number":!isNaN(t)&&++o;break;case"object":o+=e(t,r)}return o}),Me.registerProcessorFunction("COUNTA",function e(t,r){let s=Me.getArgumentsValues(t,r),o=0;for(let t,n=0,i=s.length;n<i;++n){switch(typeof(t=s[n])){case"number":if(isNaN(t))continue;break;case"object":o+=e(t,r);continue;case"string":if(!t)continue}++o}return o});let{getArgumentValue:Se}=Me;Me.registerProcessorFunction("IF",function(e,t){return Se(e[0],t)?Se(e[1],t):Se(e[2],t)});let{getArgumentValue:ke}=Me;Me.registerProcessorFunction("ISNA",function(e,t){let r=ke(e[0],t);return"number"!=typeof r||isNaN(r)});let{getArgumentsValues:Ye}=Me;Me.registerProcessorFunction("MAX",function e(t,r){let s=Ye(t,r),o=Number.NEGATIVE_INFINITY;for(let t,r=0,n=s.length;r<n;++r)switch(typeof(t=s[r])){case"number":t>o&&(o=t);break;case"object":(t=e(t))>o&&(o=t)}return isFinite(o)?o:0}),Me.registerProcessorFunction("MEDIAN",function(e,t){let r=[],s=Me.getArgumentsValues(e,t);for(let e,t=0,o=s.length;t<o;++t)switch(typeof(e=s[t])){case"number":isNaN(e)||r.push(e);break;case"object":for(let t,s=0,o=e.length;s<o;++s)"number"!=typeof(t=e[s])||isNaN(t)||r.push(t)}let o=r.length;if(!o)return NaN;let n=Math.floor(o/2);return o%2?r[n]:(r[n-1]+r[n])/2});let{getArgumentsValues:Ve}=Me;Me.registerProcessorFunction("MIN",function e(t,r){let s=Ve(t,r),o=Number.POSITIVE_INFINITY;for(let t,r=0,n=s.length;r<n;++r)switch(typeof(t=s[r])){case"number":t<o&&(o=t);break;case"object":(t=e(t))<o&&(o=t)}return isFinite(o)?o:0});let{getArgumentValue:$e}=Me;function Ue(e,t){let r={},s=Me.getArgumentsValues(e,t);for(let e,t=0,o=s.length;t<o;++t)switch(typeof(e=s[t])){case"number":isNaN(e)||(r[e]=(r[e]||0)+1);break;case"object":for(let t,s=0,o=e.length;s<o;++s)"number"!=typeof(t=e[s])||isNaN(t)||(r[t]=(r[t]||0)+1)}return r}function He(e,t){let r=Ue(e,t),s=Object.keys(r);if(!s.length)return NaN;let o=parseFloat(s[0]),n=r[s[0]];for(let e,t,i,l=1,a=s.length;l<a;++l)n<(i=r[e=s[l]])?(o=parseFloat(e),n=i):n===i&&o>(t=parseFloat(e))&&(o=t,n=i);return n>1?o:NaN}Me.registerProcessorFunction("MOD",function(e,t){let r=$e(e[0],t),s=$e(e[1],t);return"object"==typeof r&&(r=r[0]),"object"==typeof s&&(s=s[0]),"number"!=typeof r||"number"!=typeof s||0===s?NaN:r%s}),Me.registerProcessorFunction("MODE",He),Me.registerProcessorFunction("MODE.MULT",function(e,t){let r=Ue(e,t),s=Object.keys(r);if(!s.length)return NaN;let o=[parseFloat(s[0])],n=r[s[0]];for(let e,t,i=1,l=s.length;i<l;++i)n<(t=r[e=s[i]])?(o=[parseFloat(e)],n=t):n===t&&o.push(parseFloat(e));return n>1?o:NaN}),Me.registerProcessorFunction("MODE.SNGL",He);let{getArgumentValue:_e}=Me;Me.registerProcessorFunction("NOT",function(e,t){let r=_e(e[0],t);switch("object"==typeof r&&(r=r[0]),typeof r){case"boolean":case"number":return!r}return NaN});let{getArgumentValue:Be}=Me;Me.registerProcessorFunction("OR",function e(t,r){for(let s,o=0,n=t.length;o<n;++o)if("object"==typeof(s=Be(t[o],r))){if(e(s,r))return!0}else if(s)return!0;return!1});let{getArgumentsValues:Ge}=Me;Me.registerProcessorFunction("PRODUCT",function e(t,r){let s=Ge(t,r),o=1,n=!1;for(let t,i=0,l=s.length;i<l;++i)switch(typeof(t=s[i])){case"number":isNaN(t)||(n=!0,o*=t);break;case"object":n=!0,o*=e(t,r)}return n?o:0}),Me.registerProcessorFunction("SUM",function e(t,r){let s=Me.getArgumentsValues(t,r),o=0;for(let t,n=0,i=s.length;n<i;++n)switch(typeof(t=s[n])){case"number":isNaN(t)||(o+=t);break;case"object":o+=e(t,r)}return o});let{getArgumentValue:Ke}=Me;Me.registerProcessorFunction("XOR",function(e,t){for(let r,s,o=0,n=e.length;o<n;++o)switch(typeof(s=Ke(e[o],t))){case"boolean":case"number":if(void 0===r)r=!!s;else if(!!s!==r)return!0;break;case"object":for(let e,t=0,o=s.length;t<o;++t)switch(typeof(e=s[t])){case"boolean":case"number":if(void 0===r)r=!!e;else if(!!e!==r)return!0}}return!1});let Ze={...ne,...Me,...le},{merge:Je}=l();class Xe extends Y{constructor(e){let t=Je(Xe.defaultOptions,e);super(t),this.columns=[],this.headers=[],this.dataTypes=[],this.options=t}export(e,t=this.options){let{useLocalDecimalPoint:r,lineDelimiter:s}=t,o=!1!==this.options.firstRowAsNames,{decimalPoint:n,itemDelimiter:i}=t;n||(n=","!==i&&r?1.1.toLocaleString()[1]:"."),i||(i=","===n?";":",");let l=e.getSortedColumns(t.usePresentationOrder),a=Object.keys(l),u=[],h=a.length,m=[];o&&u.push(a.map(e=>`"${e}"`).join(i));for(let t=0;t<h;t++){let r,s=a[t],o=l[s],f=o.length,d=e.whatIs(s);d&&(r=d.dataType);for(let e=0;e<f;e++){let s=o[e];if(m[e]||(m[e]=[]),"string"===r?s='"'+s+'"':"number"==typeof s?s=String(s).replace(".",n):"string"==typeof s&&(s=`"${s}"`),m[e][t]=s,t===h-1){let r=t;for(;m[e].length>2&&void 0===m[e][r];)m[e].pop(),r--;u.push(m[e].join(i))}}}return u.join(s)}parse(e,t){let r,s,o=this.dataTypes,n=Je(this.options,e),{beforeParse:i,lineDelimiter:l,firstRowAsNames:a,itemDelimiter:u}=n,h=0,{csv:m,startRow:f,endRow:d}=n;if(this.columns=[],this.emit({type:"parse",columns:this.columns,detail:t,headers:this.headers}),m&&i&&(m=i(m)),m){if(r=m.replace(/\r\n|\r/g,"\n").split(l||"\n"),(!f||f<0)&&(f=0),(!d||d>=r.length)&&(d=r.length-1),u||(this.guessedItemDelimiter=this.guessDelimiter(r)),a){let e=r[0].split(u||this.guessedItemDelimiter||",");for(let t=0;t<e.length;t++)e[t]=e[t].trim().replace(/^["']|["']$/g,"");this.headers=e,f++}let e=0;for(h=f;h<=d;h++)"#"===r[h][0]?e++:this.parseCSVRow(r[h],h-f-e);o.length&&o[0].length&&"date"===o[0][1]&&!this.options.dateFormat&&this.deduceDateFormat(this.columns[0],null,!0);for(let e=0,t=this.columns.length;e<t;++e){s=this.columns[e];for(let t=0,r=s.length;t<r;++t)if(s[t]&&"string"==typeof s[t]){let r=this.asGuessedType(s[t]);r instanceof Date&&(r=r.getTime()),this.columns[e][t]=r}}}this.emit({type:"afterParse",columns:this.columns,detail:t,headers:this.headers})}parseCSVRow(e,t){let r=this,s=r.columns||[],o=r.dataTypes,{startColumn:n,endColumn:i}=r.options,l=r.options.itemDelimiter||r.guessedItemDelimiter,{decimalPoint:a}=r.options;a&&a!==l||(a=r.guessedDecimalPoint||".");let u=0,h="",m="",f=0,d=0,c=t=>{h=e[t]},p=e=>{o.length<d+1&&o.push([e]),o[d][o[d].length-1]!==e&&o[d].push(e)},g=()=>{if(n>f||f>i)return++f,void(m="");if("string"==typeof m?!isNaN(parseFloat(m))&&isFinite(m)?(m=parseFloat(m),p("number")):isNaN(Date.parse(m))?p("string"):(m=m.replace(/\//g,"-"),p("date")):p("number"),s.length<d+1&&s.push([]),"number"!=typeof m&&"number"!==r.guessType(m)&&a){let e=m;m=m.replace(a,"."),"number"!==r.guessType(m)&&(m=e)}s[d][t]=m,m="",++d,++f};if(e.trim().length&&"#"!==e.trim()[0]){for(;u<e.length;u++){if(c(u),"#"===h&&!/^#[A-F\d]{3,3}|[A-F\d]{6,6}/i.test(e.substring(u)))return void g();if('"'===h)for(c(++u);u<e.length&&'"'!==h;)m+=h,c(++u);else h===l?g():m+=h}g()}}guessDelimiter(e){let t,r=0,s=0,o={",":0,";":0,"\t":0},n=e.length;for(let t=0;t<n;t++){let n,i,l,a=!1,u="";if(t>13)break;let h=e[t];for(let e=0;e<h.length&&(n=h[e],i=h[e+1],l=h[e-1],"#"!==n);e++){if('"'===n)if(a){if('"'!==l&&'"'!==i){for(;" "===i&&e<h.length;)i=h[++e];void 0!==o[i]&&o[i]++,a=!1}}else a=!0;else void 0!==o[n]?(isNaN(Date.parse(u=u.trim()))?(isNaN(Number(u))||!isFinite(Number(u)))&&o[n]++:o[n]++,u=""):u+=n;","===n&&s++,"."===n&&r++}}return o[";"]>o[","]?t=";":(o[","],o[";"],t=","),this.guessedDecimalPoint=r>s?".":",",t}getTable(){return Y.getTableFromColumns(this.columns,this.headers)}}Xe.defaultOptions={...Y.defaultOptions,lineDelimiter:"\n"},Y.registerType("CSV",Xe);let{merge:qe,defined:ze}=l();class Qe extends P{constructor(e,t){let r=qe(Qe.defaultOptions,e);super(r,t),this.options=ze(t)?qe(r,{dataTables:t}):r,r.enablePolling&&this.startPolling(1e3*Math.max(r.dataRefreshRate||0,1))}load(e){let t=this,r=t.dataTables,{csv:s,csvURL:o,dataModifier:n,dataTables:i}=t.options;return t.emit({type:"load",csv:s,detail:e,tables:r}),Promise.resolve(o?fetch(o,{signal:t?.pollingController?.signal}).then(e=>e.text()):s||"").then(e=>(e&&this.initConverters(e,e=>{let t=this.options,r=i?.find(t=>t.key===e),s={dataTableKey:e,firstRowAsNames:r?.firstRowAsNames??t.firstRowAsNames,beforeParse:r?.beforeParse??t.beforeParse};return new Xe(qe(this.options,s))},(e,t)=>{e.parse({csv:t})}),t.setModifierOptions(n,i).then(()=>e))).then(s=>(t.emit({type:"afterLoad",csv:s,detail:e,tables:r}),t)).catch(s=>{throw t.emit({type:"loadError",detail:e,error:s,tables:r}),s})}}Qe.defaultOptions={csv:"",csvURL:"",enablePolling:!1,dataRefreshRate:1,firstRowAsNames:!0},P.registerType("CSV",Qe);let{error:We,isArray:et,merge:tt,objectEach:rt}=l();class st extends Y{constructor(e){let t=tt(st.defaultOptions,e);super(t),this.columns=[],this.headers=[],this.options=t,this.table=new A}parse(e,t){let{beforeParse:r,orientation:s,firstRowAsNames:o,columnNames:n}=e=tt(this.options,e),i=e.data;if(i){if(this.columns=[],this.emit({type:"parse",columns:this.columns,detail:t,headers:this.headers}),r&&(i=r(i)),i=i.slice(),"columns"===s)for(let e=0,t=i.length;e<t;e++){let t=i[e];if(!(t instanceof Array))return;this.headers instanceof Array?(o?this.headers.push(`${t.shift()}`):n&&n instanceof Array&&this.headers.push(n[e]),this.table.setColumn(this.headers[e]||e.toString(),t)):We("JSONConverter: Invalid `columnNames` option.",!1)}else if("rows"===s){o?this.headers=i.shift():n&&(this.headers=n);for(let e=0,t=i.length;e<t;e++){let t=i[e];if(et(t))for(let e=0,r=t.length;e<r;e++)this.columns.length<e+1&&this.columns.push([]),this.columns[e].push(t[e]),this.headers instanceof Array?this.table.setColumn(this.headers[e]||e.toString(),this.columns[e]):We("JSONConverter: Invalid `columnNames` option.",!1);else{let r=this.headers;if(r&&!(r instanceof Array)){let e={};rt(r,(r,s)=>{e[s]=r.reduce((e,t)=>e[t],t)}),t=e}this.table.setRows([t],e)}}}this.emit({type:"afterParse",columns:this.columns,detail:t,headers:this.headers})}}getTable(){return this.table}}st.defaultOptions={...Y.defaultOptions,orientation:"rows"},Y.registerType("JSON",st);let{merge:ot,defined:nt}=l();class it extends P{constructor(e,t){let r=ot(it.defaultOptions,e);super(r,t),this.options=nt(t)?ot(r,{dataTables:t}):r,r.enablePolling&&this.startPolling(1e3*Math.max(r.dataRefreshRate||0,1))}load(e){let t=this,r=t.dataTables,{data:s,dataUrl:o,dataModifier:n,dataTables:i}=t.options;return t.emit({type:"load",data:s,detail:e,tables:r}),Promise.resolve(o?fetch(o,{signal:t?.pollingController?.signal}).then(e=>e.json()).catch(s=>{t.emit({type:"loadError",detail:e,error:s,tables:r}),console.warn(`Unable to fetch data from ${o}.`)}):s||[]).then(e=>(e&&this.initConverters(e,e=>{let t=this.options,r=i?.find(t=>t.key===e),s={dataTableKey:e,columnNames:r?.columnNames??t.columnNames,firstRowAsNames:r?.firstRowAsNames??t.firstRowAsNames,orientation:r?.orientation??t.orientation,beforeParse:r?.beforeParse??t.beforeParse};return new st(ot(this.options,s))},(e,t)=>{e.parse({data:t})}),t.setModifierOptions(n,i).then(()=>e))).then(s=>(t.emit({type:"afterLoad",data:s,detail:e,tables:r}),t)).catch(s=>{throw t.emit({type:"loadError",detail:e,error:s,tables:r}),s})}}it.defaultOptions={enablePolling:!1,dataRefreshRate:0,firstRowAsNames:!0,orientation:"rows"},P.registerType("JSON",it);let{merge:lt,uniqueKey:at}=l();class ut extends Y{constructor(e){let t=lt(ut.defaultOptions,e);super(t),this.columns=[],this.header=[],this.options=t}parse(e,t){let r,s=lt(this.options,e),o=(s.json?.values||[]).map(e=>e.slice());if(0===o.length)return!1;this.header=[],this.columns=[],this.emit({type:"parse",columns:this.columns,detail:t,headers:this.header});let{beforeParse:n,json:i}=s;n&&i&&(o=n(i.values)),this.columns=o;for(let e=0,t=o.length;e<t;e++){r=o[e],this.header[e]=s.firstRowAsNames?`${r.shift()}`:at();for(let t=0,s=r.length;t<s;++t)if(r[t]&&"string"==typeof r[t]){let s=this.asGuessedType(r[t]);s instanceof Date&&(s=s.getTime()),this.columns[e][t]=s}}this.emit({type:"afterParse",columns:this.columns,detail:t,headers:this.header})}getTable(){return Y.getTableFromColumns(this.columns,this.header)}}ut.defaultOptions={...Y.defaultOptions},Y.registerType("GoogleSheets",ut);let{merge:ht,pick:mt,defined:ft}=l();class dt extends P{constructor(e,t){let r=ht(dt.defaultOptions,e);super(r,t),this.options=ft(t)?ht(r,{dataTables:t}):r}load(e){let t=this,r=t.dataTables,{dataModifier:s,dataRefreshRate:o,enablePolling:n,googleAPIKey:i,googleSpreadsheetKey:l,dataTables:a}=t.options,u=dt.buildFetchURL(i,l,t.options);if(t.emit({type:"load",detail:e,tables:r,url:u}),!URL.canParse(u))throw Error("Invalid URL: "+u);return fetch(u,{signal:t?.pollingController?.signal}).then(e=>e.json()).then(e=>{if("object"==typeof e&&e&&"object"==typeof e.error&&e.error&&"number"==typeof e.error.code&&"string"==typeof e.error.message&&"string"==typeof e.error.status)throw Error(e.error.message);return this.initConverters(e,e=>{let t=this.options,r=a?.find(t=>t.key===e),s={dataTableKey:e,firstRowAsNames:r?.firstRowAsNames??t.firstRowAsNames,beforeParse:r?.beforeParse??t.beforeParse};return new ut(ht(this.options,s))},(e,t)=>{e.parse({json:t})}),t.setModifierOptions(s,a)}).then(()=>(t.emit({type:"afterLoad",detail:e,tables:r,url:u}),n&&setTimeout(()=>t.load(),1e3*Math.max(o||0,1)),t)).catch(s=>{throw t.emit({type:"loadError",detail:e,error:s,tables:r}),s})}}dt.defaultOptions={googleAPIKey:"",googleSpreadsheetKey:"",enablePolling:!1,dataRefreshRate:2,firstRowAsNames:!0},function(e){let t="ABCDEFGHIJKLMNOPQRSTUVWXYZ";function r(e={}){let{endColumn:r,endRow:s,googleSpreadsheetRange:o,startColumn:n,startRow:i}=e;return o||(t[n||0]||"A")+(Math.max(i||0,0)+1)+":"+(t[mt(r,25)]||"Z")+(s?Math.max(s,0):"Z")}e.buildFetchURL=function(e,t,s={}){let o=new URL(`https://sheets.googleapis.com/v4/spreadsheets/${t}/values/`),n=s.onlyColumnNames?"A1:Z1":r(s);o.pathname+=n;let i=o.searchParams;return i.set("alt","json"),s.onlyColumnNames||(i.set("dateTimeRenderOption","FORMATTED_STRING"),i.set("majorDimension","COLUMNS"),i.set("valueRenderOption","UNFORMATTED_VALUE")),i.set("prettyPrint","false"),i.set("key",e),o.href},e.buildQueryRange=r}(dt||(dt={})),P.registerType("GoogleSheets",dt);let{merge:ct}=l();class pt extends Y{constructor(e){let t=ct(pt.defaultOptions,e);super(t),this.columns=[],this.headers=[],this.options=t,t.tableElement&&(this.tableElement=t.tableElement,this.tableElementID=t.tableElement.id)}export(e,t=this.options){let r=!1!==t.firstRowAsNames,s=t.useMultiLevelHeaders,o=e.getSortedColumns(t.usePresentationOrder),n=Object.keys(o),i=[],l=n.length,a=[],u="";if(r){let e=[];if(s){for(let t of n){let r=o[t];Array.isArray(r)||(r=Array.from(r));let s=(r.shift()||"").toString();o[t]=r,e.push(s)}u=this.getTableHeaderHTML(n,e,t)}else u=this.getTableHeaderHTML(void 0,n,t)}for(let e=0;e<l;e++){let t=o[n[e]],r=t.length;for(let s=0;s<r;s++){let r=t[s];a[s]||(a[s]=[]),"string"!=typeof r&&"number"!=typeof r&&void 0!==r&&(r=(r||"").toString()),a[s][e]=this.getCellHTMLFromValue(e?"td":"th",null,e?"":'scope="row"',r),e===l-1&&i.push("<tr>"+a[s].join("")+"</tr>")}}let h="";return t.tableCaption&&(h='<caption class="highcharts-table-caption">'+t.tableCaption+"</caption>"),"<table>"+h+u+"<tbody>"+i.join("")+"</tbody></table>"}getCellHTMLFromValue(e,t,r,s,o){let n=s,i="text"+(t?" "+t:"");return"number"==typeof n?(n=n.toString(),","===o&&(n=n.replace(".",o)),i="number"):s||(n="",i="empty"),"<"+e+(r?" "+r:"")+' class="'+i+'">'+n+"</"+e+">"}getTableHeaderHTML(e=[],t=[],r=this.options){let s,o,{useMultiLevelHeaders:n,useRowspanHeaders:i}=r,l="<thead>",a=0,u=t&&t.length,h=0;if(n&&e&&t&&!function(e,t){let r=e.length;if(t.length!==r)return!1;for(;--r;)if(e[r]!==t[r])return!1;return!0}(e,t)){for(l+="<tr>";a<u;++a)(s=e[a])===e[a+1]?++h:h?(l+=this.getCellHTMLFromValue("th","highcharts-table-topheading",'scope="col" colspan="'+(h+1)+'"',s),h=0):(s===t[a]?i?(o=2,t.splice(a,1)):(o=1,t[a]=""):o=1,l+=this.getCellHTMLFromValue("th","highcharts-table-topheading",'scope="col"'+(o>1?' valign="top" rowspan="'+o+'"':""),s));l+="</tr>"}if(t){for(l+="<tr>",a=0,u=t.length;a<u;++a)void 0!==t[a]&&(l+=this.getCellHTMLFromValue("th",null,'scope="col"',t[a]));l+="</tr>"}return l+"</thead>"}parse(e,t){let r=[],s=[],o=ct(this.options,e),{endRow:n,startColumn:i,endColumn:l,firstRowAsNames:a}=o,u=o.tableElement||this.tableElement;if(!(u instanceof HTMLElement))return void this.emit({type:"parseError",columns:r,detail:t,headers:s,error:"Not a valid HTML Table"});this.tableElement=u,this.tableElementID=u.id,this.emit({type:"parse",columns:this.columns,detail:t,headers:this.headers});let h,m=u.getElementsByTagName("tr"),f=m.length,d=0,{startRow:c}=o;if(a&&f){let e=m[0].children,t=e.length;for(let r=i;r<t&&!(r>l);r++)("TD"===(h=e[r]).tagName||"TH"===h.tagName)&&s.push(h.innerHTML);c++}for(;d<f;){if(d>=c&&d<=n){let e=m[d].children,t=e.length,s=0;for(;s<t;){let t=s-i,o=r[t];if(("TD"===(h=e[s]).tagName||"TH"===h.tagName)&&s>=i&&s<=l){r[t]||(r[t]=[]);let e=this.asGuessedType(h.innerHTML);e instanceof Date&&(e=e.getTime()),r[t][d-c]=e;let s=1;for(;d-c>=s&&void 0===o[d-c-s];)o[d-c-s]=null,s++}s++}}d++}this.columns=r,this.headers=s,this.emit({type:"afterParse",columns:r,detail:t,headers:s})}getTable(){return Y.getTableFromColumns(this.columns,this.headers)}}pt.defaultOptions={...Y.defaultOptions,useRowspanHeaders:!0,useMultiLevelHeaders:!0},Y.registerType("HTMLTable",pt);let{win:gt}=l(),{merge:yt}=l();class bt extends P{constructor(e){let t=yt(bt.defaultOptions,e);super(t),this.converter=new pt(t),this.options=t}load(e){let t,r=this,s=r.converter,o=r.table,{dataModifier:n,table:i}=r.options;if(r.emit({type:"load",detail:e,tables:{table:o},tableElement:r.tableElement}),"string"==typeof i?(r.tableID=i,t=gt.document.getElementById(i)):r.tableID=(t=i).id,r.tableElement=t||void 0,!r.tableElement){let t="HTML table not provided, or element with ID not found";return r.emit({type:"loadError",detail:e,error:t,tables:{table:o}}),Promise.reject(Error(t))}return s.parse(yt({tableElement:r.tableElement},r.options),e),o.deleteColumns(),o.setColumns(s.getTable().getColumns()),r.setModifierOptions(n).then(()=>(r.emit({type:"afterLoad",detail:e,tables:{table:o},tableElement:r.tableElement}),r))}}bt.defaultOptions={table:""},P.registerType("HTMLTable",bt);let{merge:wt}=l();class Ct extends f{constructor(e,...t){super(),this.chain=t,this.options=wt(Ct.defaultOptions,e);let r=this.options.chain||[];for(let e,s,o=0,n=r.length;o<n;++o)(e=r[o]).type&&(s=f.types[e.type])&&t.push(new s(e))}add(e,t){this.emit({type:"addModifier",detail:t,modifier:e}),this.chain.push(e),this.emit({type:"addModifier",detail:t,modifier:e})}clear(e){this.emit({type:"clearChain",detail:e}),this.chain.length=0,this.emit({type:"afterClearChain",detail:e})}async modify(e,t){let r=this.options.reverse?this.chain.slice().reverse():this.chain.slice();e.modified===e&&(e.modified=e.clone(!1,t));let s=e;for(let o=0,n=r.length;o<n;++o){try{await r[o].modify(s,t)}catch(r){throw this.emit({type:"error",detail:t,table:e}),r}s=s.modified}return e.modified=s,e}modifyCell(e,t,r,s,o){let n=this.options.reverse?this.chain.reverse():this.chain;if(n.length){let i=e.clone();for(let e=0,l=n.length;e<l;++e)n[e].modifyCell(i,t,r,s,o),i=i.modified;e.modified=i}return e}modifyColumns(e,t,r,s){let o=this.options.reverse?this.chain.reverse():this.chain.slice();if(o.length){let n=e.clone();for(let e=0,i=o.length;e<i;++e)o[e].modifyColumns(n,t,r,s),n=n.modified;e.modified=n}return e}modifyRows(e,t,r,s){let o=this.options.reverse?this.chain.reverse():this.chain.slice();if(o.length){let n=e.clone();for(let e=0,i=o.length;e<i;++e)o[e].modifyRows(n,t,r,s),n=n.modified;e.modified=n}return e}modifyTable(e,t){this.emit({type:"modify",detail:t,table:e});let r=this.options.reverse?this.chain.reverse():this.chain.slice(),s=e.modified;for(let e=0,o=r.length;e<o;++e)s=r[e].modifyTable(s,t).modified;return e.modified=s,this.emit({type:"afterModify",detail:t,table:e}),e}remove(e,t){let r=this.chain;this.emit({type:"removeModifier",detail:t,modifier:e}),r.splice(r.indexOf(e),1),this.emit({type:"afterRemoveModifier",detail:t,modifier:e})}}Ct.defaultOptions={type:"Chain"},f.registerType("Chain",Ct);let{merge:Rt}=l();class Nt extends f{constructor(e){super(),this.options=Rt(Nt.defaultOptions,e)}modifyCell(e,t,r,s,o){let n=e.modified,i=n.getRowIndexBy("columnNames",t);return void 0===i?n.setColumns(this.modifyTable(e.clone()).getColumns(),void 0,o):n.setCell(`${r}`,i,s,o),e}modifyColumns(e,t,r,s){let o=e.modified,n=o.getColumn("columnNames")||[],i=e.getColumnNames(),l=e.getRowCount()!==n.length;if(!l)for(let e=0,t=i.length;e<t;++e)if(i[e]!==n[e]){l=!0;break}if(l)return this.modifyTable(e,s);i=Object.keys(t);for(let e,n,l,a=0,u=i.length;a<u;++a){e=t[n=i[a]],l=o.getRowIndexBy("columnNames",n)||o.getRowCount();for(let t=0,n=r,i=e.length;t<i;++t,++n)o.setCell(`${n}`,l,e[t],s)}return e}modifyRows(e,t,r,s){let o=e.getColumnNames(),n=e.modified,i=n.getColumn("columnNames")||[],l=e.getRowCount()!==i.length;if(!l)for(let e=0,t=o.length;e<t;++e)if(o[e]!==i[e]){l=!0;break}if(l)return this.modifyTable(e,s);for(let e,i=0,l=r,a=t.length;i<a;++i,++l)if((e=t[i])instanceof Array)n.setColumn(`${l}`,e);else for(let t=0,r=o.length;t<r;++t)n.setCell(`${l}`,t,e[o[t]],s);return e}modifyTable(e,t){this.emit({type:"modify",detail:t,table:e});let r=e.modified;if(e.hasColumns(["columnNames"])){let t=(e.deleteColumns(["columnNames"])||{}).columnNames||[],s={},o=[];for(let e=0,r=t.length;e<r;++e)o.push(""+t[e]);for(let t,r=0,n=e.getRowCount();r<n;++r)(t=e.getRow(r))&&(s[o[r]]=t);r.deleteColumns(),r.setColumns(s)}else{let t={};for(let r,s=0,o=e.getRowCount();s<o;++s)(r=e.getRow(s))&&(t[`${s}`]=r);t.columnNames=e.getColumnNames(),r.deleteColumns(),r.setColumns(t)}return this.emit({type:"afterModify",detail:t,table:e}),e}}Nt.defaultOptions={type:"Invert"},f.registerType("Invert",Nt);class Tt extends f{constructor(e){super(),this.options={...Tt.defaultOptions,...e}}modifyTable(e,t){this.emit({type:"modify",detail:t,table:e});let r=this.options.alternativeSeparators,s=this.options.formulaColumns||e.getColumnNames(),o=e.modified;for(let t,r=0,n=s.length;r<n;++r)t=s[r],s.indexOf(t)>=0&&o.setColumn(t,this.processColumn(e,t));let n=this.options.columnFormulas||[];for(let t,s,i=0,l=n.length;i<l;++i)t=n[i],s=ne.parseFormula(t.formula,r),o.setColumn(t.column,this.processColumnFormula(s,e,t.rowStart,t.rowEnd));return this.emit({type:"afterModify",detail:t,table:e}),e}processColumn(e,t,r=0){let s=this.options.alternativeSeparators,o=(e.getColumn(t,!0)||[]).slice(r>0?r:0);for(let t,r=0,n=o.length,i=[];r<n;++r)if("string"==typeof(t=o[r])&&"="===t[0])try{i=""===t?i:ne.parseFormula(t.substring(1),s),o[r]=Me.processFormula(i,e)}catch{o[r]=NaN}return o}processColumnFormula(e,t,r=0,s=t.getRowCount()){r=r>=0?r:0,s=s>=0?s:t.getRowCount()+s;let o=[],n=t.modified;for(let t=0,i=s-r;t<i;++t)try{o[t]=Me.processFormula(e,n)}catch{o[t]=NaN}finally{e=Me.translateReferences(e,0,1)}return o}}Tt.defaultOptions={type:"Math",alternativeSeparators:!1},f.registerType("Math",Tt);let{merge:vt}=l();class Ot extends f{constructor(e){super(),this.options=vt(Ot.defaultOptions,e)}modifyTable(e,t){this.emit({type:"modify",detail:t,table:e});let r=[],{additive:s,ranges:o,strict:n}=this.options;if(o.length){let t=e.modified,i=e.getColumns(),l=[];for(let e,a,u=0,h=o.length;u<h;++u)if(e=o[u],!n||typeof e.minValue==typeof e.maxValue){u>0&&!s&&(t.deleteRows(),t.setRows(l),t.setOriginalRowIndexes(r,!0),i=t.getColumns(),l=[],r=[]),a=i[e.column]||[];for(let e=0,t=a.length;e<t;++e)switch(typeof a[e]){default:continue;case"boolean":case"number":case"string":}}t.deleteRows(),t.setRows(l),t.setOriginalRowIndexes(r)}return this.emit({type:"afterModify",detail:t,table:e}),e}}Ot.defaultOptions={type:"Range",ranges:[]},f.registerType("Range",Ot);let{merge:At}=l();class xt extends f{static ascending(e,t){return(e||0)<(t||0)?-1:+((e||0)>(t||0))}static descending(e,t){return(t||0)<(e||0)?-1:+((t||0)>(e||0))}static compareFactory(e,t){return t?"desc"===e?(e,r)=>-t(e,r):t:"asc"===e?xt.ascending:xt.descending}constructor(e){super(),this.options=At(xt.defaultOptions,e)}getRowReferences(e){let t=e.getRows(),r=[];for(let e=0,s=t.length;e<s;++e)r.push({index:e,row:t[e]});return r}modifyCell(e,t,r,s,o){let{orderByColumn:n,orderInColumn:i}=this.options;return t===n&&(i?(e.modified.setCell(t,r,s),e.modified.setColumn(i,this.modifyTable(new A({columns:e.getColumns([n,i])})).modified.getColumn(i))):this.modifyTable(e,o)),e}modifyColumns(e,t,r,s){let{orderByColumn:o,orderInColumn:n}=this.options,i=Object.keys(t);return i.indexOf(o)>-1&&(n&&t[i[0]].length?(e.modified.setColumns(t,r),e.modified.setColumn(n,this.modifyTable(new A({columns:e.getColumns([o,n])})).modified.getColumn(n))):this.modifyTable(e,s)),e}modifyRows(e,t,r,s){let{orderByColumn:o,orderInColumn:n}=this.options;return n&&t.length?(e.modified.setRows(t,r),e.modified.setColumn(n,this.modifyTable(new A({columns:e.getColumns([o,n])})).modified.getColumn(n))):this.modifyTable(e,s),e}modifyTable(e,t){this.emit({type:"modify",detail:t,table:e});let r=e.getColumnNames(),s=e.getRowCount(),o=this.getRowReferences(e),{direction:n,orderByColumn:i,orderInColumn:l,compare:a}=this.options,u=xt.compareFactory(n,a),h=r.indexOf(i),m=e.modified;if(-1!==h&&o.sort((e,t)=>u(e.row[h],t.row[h])),l){let e=[];for(let t=0;t<s;++t)e[o[t].index]=t;m.setColumns({[l]:e})}else{let e,t=[],r=[];for(let n=0;n<s;++n)e=o[n],t.push(m.getOriginalRowIndex(e.index)),r.push(e.row);m.setRows(r,0),m.setOriginalRowIndexes(t)}return this.emit({type:"afterModify",detail:t,table:e}),e}}xt.defaultOptions={type:"Sort",direction:"desc",orderByColumn:"y"},f.registerType("Sort",xt);let{isFunction:Ft,merge:Et}=l();class It extends f{static compile(e){if(Ft(e))return e;let t=e.operator;switch(t){case"and":{let t=e.conditions.map(e=>this.compile(e));return(e,r,s)=>t.every(t=>t(e,r,s))}case"or":{let t=e.conditions.map(e=>this.compile(e));return(e,r,s)=>t.some(t=>t(e,r,s))}case"not":{let t=this.compile(e.condition);return(e,r,s)=>!t(e,r,s)}}let{columnName:r,value:s}=e;switch(t){case"==":return e=>e[r]==s;case"===":return e=>e[r]===s;case"!=":return e=>e[r]!=s;case"!==":return e=>e[r]!==s;case">":return e=>(e[r]||0)>(s||0);case">=":return e=>(e[r]||0)>=(s||0);case"<":return e=>(e[r]||0)<(s||0);case"<=":return e=>(e[r]||0)<=(s||0)}let{ignoreCase:o}=e,n=e=>{let t=""+e;return o??1?t.toLowerCase():t};return"contains"===t?e=>n(e[r]).includes(n(s)):e=>n(e[r])[t](n(s))}constructor(e){super(),this.options=Et(It.defaultOptions,e)}modifyTable(e,t){this.emit({type:"modify",detail:t,table:e});let{condition:r}=this.options;if(!r)return e;let s=It.compile(r),o=e.modified,n=[],i=[];for(let t=0,r=e.getRowCount();t<r;++t){let r=e.getRowObject(t);r&&s(r,e,t)&&(n.push(r),i.push(o.getOriginalRowIndex(t)))}return o.deleteRows(),o.setRows(n),o.setOriginalRowIndexes(i),this.emit({type:"afterModify",detail:t,table:e}),e}}It.defaultOptions={type:"Filter"},f.registerType("Filter",It);let Mt=l();Mt.DataConnector=Mt.DataConnector||P,Mt.DataConverter=Mt.DataConverter||Y,Mt.DataCursor=Mt.DataCursor||$,Mt.DataModifier=Mt.DataModifier||f,Mt.DataPool=Mt.DataPool||H,Mt.DataTable=Mt.DataTable||A,Mt.Formula=Mt.Formula||Ze;let Pt=l();return n.default})())(o._Highcharts)),i=t({__proto__:null,default:e(n)},[n]);export{i as d};
//# sourceMappingURL=data-tools-DQi0qw-m.js.map
