import{g as t}from"./index-B1MHyEgd.js";function e(t,e){return e.forEach(function(e){e&&"string"!=typeof e&&!Array.isArray(e)&&Object.keys(e).forEach(function(n){if("default"!==n&&!(n in t)){var i=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,i.get?i:{enumerable:!0,get:function(){return e[n]}})}})}),Object.freeze(t)}var n,i={exports:{}};var r,a=n?i.exports:(n=1,r="undefined"==typeof window?i.exports:window,i.exports=((t,e)=>(()=>{var n,i={260:t=>{t.exports=e},944:e=>{e.exports=t}},r={};function a(t){var e=r[t];if(void 0!==e)return e.exports;var n=r[t]={exports:{}};return i[t](n,n.exports,a),n.exports}a.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return a.d(e,{a:e}),e},a.d=(t,e)=>{for(var n in e)a.o(e,n)&&!a.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},a.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);var o={};a.d(o,{default:()=>F});var s=a(944),h=a.n(s);let{defined:c,error:l,merge:x,objectEach:M}=h(),d=h().deg2rad,y=Math.max,p=Math.min,f=class{constructor(t,e,n){this.init(t,e,n)}init(t,e,n){this.fromPoint=t,this.toPoint=e,this.options=n,this.chart=t.series.chart,this.pathfinder=this.chart.pathfinder}renderPath(t,e){let n=this.chart,i=n.styledMode,r=this.pathfinder,a={},o=this.graphics&&this.graphics.path;r.group||(r.group=n.renderer.g().addClass("highcharts-pathfinder-group").attr({zIndex:-1}).add(n.seriesGroup)),r.group.translate(n.plotLeft,n.plotTop),!(o&&o.renderer)&&(o=n.renderer.path().add(r.group),i||o.attr({opacity:0})),o.attr(e),a.d=t,i||(a.opacity=1),o.animate(a),this.graphics=this.graphics||{},this.graphics.path=o}addMarker(t,e,n){let i,r,a,o,s,h,c,l=this.fromPoint.series.chart,x=l.pathfinder,M=l.renderer,y="start"===t?this.fromPoint:this.toPoint,p=y.getPathfinderAnchorPoint(e);e.enabled&&((c="start"===t?n[1]:n[n.length-2])&&"M"===c[0]||"L"===c[0])&&(h={x:c[1],y:c[2]},r=y.getRadiansToVector(h,p),i=y.getMarkerVector(r,e.radius,p),e.width&&e.height?(o=e.width,s=e.height):o=s=2*e.radius,this.graphics=this.graphics||{},a={x:i.x-o/2,y:i.y-s/2,width:o,height:s,rotation:-r/d,rotationOriginX:i.x,rotationOriginY:i.y},this.graphics[t]?this.graphics[t].animate(a):(this.graphics[t]=M.symbol(e.symbol).addClass("highcharts-point-connecting-path-"+t+"-marker highcharts-color-"+this.fromPoint.colorIndex).attr(a).add(x.group),M.styledMode||this.graphics[t].attr({fill:e.color||this.fromPoint.color,stroke:e.lineColor,"stroke-width":e.lineWidth,opacity:0}).animate({opacity:1},y.series.options.animation)))}getPath(t){let e=this.pathfinder,n=this.chart,i=e.algorithms[t.type],r=e.chartObstacles;return"function"!=typeof i?(l('"'+t.type+'" is not a Pathfinder algorithm.'),{path:[],obstacles:[]}):(i.requiresObstacles&&!r&&(r=e.chartObstacles=e.getChartObstacles(t),n.options.connectors.algorithmMargin=t.algorithmMargin,e.chartObstacleMetrics=e.getObstacleMetrics(r)),i(this.fromPoint.getPathfinderAnchorPoint(t.startMarker),this.toPoint.getPathfinderAnchorPoint(t.endMarker),x({chartObstacles:r,lineObstacles:e.lineObstacles||[],obstacleMetrics:e.chartObstacleMetrics,hardBounds:{xMin:0,xMax:n.plotWidth,yMin:0,yMax:n.plotHeight},obstacleOptions:{margin:t.algorithmMargin},startDirectionX:e.getAlgorithmStartDirection(t.startMarker)},t)))}render(){let t=this.fromPoint,e=t.series,n=e.chart,i=n.pathfinder,r={},a=x(n.options.connectors,e.options.connectors,t.options.connectors,this.options);!n.styledMode&&(r.stroke=a.lineColor||t.color,r["stroke-width"]=a.lineWidth,a.dashStyle&&(r.dashstyle=a.dashStyle)),r.class="highcharts-point-connecting-path highcharts-color-"+t.colorIndex,c((a=x(r,a)).marker.radius)||(a.marker.radius=p(y(Math.ceil((a.algorithmMargin||8)/2)-1,1),5));let o=this.getPath(a),s=o.path;o.obstacles&&(i.lineObstacles=i.lineObstacles||[],i.lineObstacles=i.lineObstacles.concat(o.obstacles)),this.renderPath(s,r),this.addMarker("start",x(a.marker,a.startMarker),s),this.addMarker("end",x(a.marker,a.endMarker),s)}destroy(){this.graphics&&(M(this.graphics,function(t){t.destroy()}),delete this.graphics)}},u=function(t,e){let n=[];for(let i=0;i<t.length;i++){let r=t[i][1],a=t[i][2];if("number"==typeof r&&"number"==typeof a)if(0===i)n.push(["M",r,a]);else if(i===t.length-1)n.push(["L",r,a]);else if(e){let o=t[i-1],s=t[i+1];if(o&&s){let t=o[1],i=o[2],h=s[1],c=s[2];if("number"==typeof t&&"number"==typeof h&&"number"==typeof i&&"number"==typeof c&&t!==h&&i!==c){let o=t<h?1:-1,s=i<c?1:-1;n.push(["L",r-o*Math.min(Math.abs(r-t),e),a-s*Math.min(Math.abs(a-i),e)],["C",r,a,r,a,r+o*Math.min(Math.abs(r-h),e),a+s*Math.min(Math.abs(a-c),e)])}}}else n.push(["L",r,a])}return n},{pick:g}=h(),{min:m,max:b,abs:P}=Math;function v(t,e,n){let i,r,a=e-1e-7,o=0,s=t.length-1;for(;o<=s;)if((r=a-t[i=s+o>>1].xMin)>0)o=i+1;else{if(!(r<0))return i;s=i-1}return o>0?o-1:0}function O(t,e){let n=v(t,e.x+1)+1;for(;n--;){var i;if(t[n].xMax>=e.x&&(i=t[n],e.x<=i.xMax&&e.x>=i.xMin&&e.y<=i.yMax&&e.y>=i.yMin))return n}return-1}function k(t){let e=[];if(t.length){e.push(["M",t[0].start.x,t[0].start.y]);for(let n=0;n<t.length;++n)e.push(["L",t[n].end.x,t[n].end.y])}return e}function w(t,e){t.yMin=b(t.yMin,e.yMin),t.yMax=m(t.yMax,e.yMax),t.xMin=b(t.xMin,e.xMin),t.xMax=m(t.xMax,e.xMax)}let A=function(t,e,n){let i,r,a,o,s,h=[],c=n.chartObstacles,l=O(c,t),x=O(c,e),M=g(n.startDirectionX,P(e.x-t.x)>P(e.y-t.y))?"x":"y";function d(t,e,n,i,r){let a={x:t.x,y:t.y};return a[e]=n[i||e]+(r||0),a}function y(t,e,n){let i=P(e[n]-t[n+"Min"])>P(e[n]-t[n+"Max"]);return d(e,n,t,n+(i?"Max":"Min"),i?1:-1)}x>-1?(i={start:a=y(c[x],e,M),end:e},s=a):s=e,l>-1&&(a=y(r=c[l],t,M),h.push({start:t,end:a}),a[M]>=t[M]==a[M]>=s[M]&&(o=t[M="y"===M?"x":"y"]<e[M],h.push({start:a,end:d(a,M,r,M+(o?"Max":"Min"),o?1:-1)}),M="y"===M?"x":"y"));let p=h.length?h[h.length-1].end:t;a=d(p,M,s),h.push({start:p,end:a});let f=d(a,M="y"===M?"x":"y",s);return h.push({start:a,end:f}),h.push(i),{path:u(k(h),n.radius),obstacles:h}};function E(t,e,n){let i,r,a,o=g(n.startDirectionX,P(e.x-t.x)>P(e.y-t.y)),s=o?"x":"y",h=[],c=n.obstacleMetrics,l=m(t.x,e.x)-c.maxWidth-10,x=b(t.x,e.x)+c.maxWidth+10,M=m(t.y,e.y)-c.maxHeight-10,d=b(t.y,e.y)+c.maxHeight+10,y=!1,p=n.chartObstacles,f=v(p,x),u=v(p,l);function A(t,e,n){let i,r,a,o,s=t.x<e.x?1:-1;t.x<e.x?(i=t,r=e):(i=e,r=t),t.y<e.y?(o=t,a=e):(o=e,a=t);let h=s<0?m(v(p,r.x),p.length-1):0;for(;p[h]&&(s>0&&p[h].xMin<=r.x||s<0&&p[h].xMax>=i.x);){if(p[h].xMin<=r.x&&p[h].xMax>=i.x&&p[h].yMin<=a.y&&p[h].yMax>=o.y)return n?{y:t.y,x:t.x<e.x?p[h].xMin-1:p[h].xMax+1,obstacle:p[h]}:{x:t.x,y:t.y<e.y?p[h].yMin-1:p[h].yMax+1,obstacle:p[h]};h+=s}return e}function E(t,e,n,i,r){let a=r.soft,o=r.hard,s=i?"x":"y",h={x:e.x,y:e.y},c={x:e.x,y:e.y},l=t[s+"Max"]>=a[s+"Max"],x=t[s+"Min"]<=a[s+"Min"],M=t[s+"Max"]>=o[s+"Max"],d=t[s+"Min"]<=o[s+"Min"],y=P(t[s+"Min"]-e[s]),p=P(t[s+"Max"]-e[s]),f=10>P(y-p)?e[s]<n[s]:p<y;c[s]=t[s+"Min"],h[s]=t[s+"Max"];let u=A(e,c,i)[s]!==c[s],g=A(e,h,i)[s]!==h[s];return f=u?!g||f:!g&&f,f=x?!l||f:!l&&f,d?!M||f:!M&&f}for((f=O(p=p.slice(u,f+1),e))>-1&&(a=function(t,e,i){let r=m(t.xMax-e.x,e.x-t.xMin)<m(t.yMax-e.y,e.y-t.yMin),a=E(t,e,i,r,{soft:n.hardBounds,hard:n.hardBounds});return r?{y:e.y,x:t[a?"xMax":"xMin"]+(a?1:-1)}:{x:e.x,y:t[a?"yMax":"yMin"]+(a?1:-1)}}(p[f],e,t),h.push({end:e,start:a}),e=a);(f=O(p,e))>-1;)r=e[s]-t[s]<0,(a={x:e.x,y:e.y})[s]=p[f][r?s+"Max":s+"Min"]+(r?1:-1),h.push({end:e,start:a}),e=a;return{path:k(i=(i=function t(e,i,r){let a,o,s,h,c,f,u;if(e.x===i.x&&e.y===i.y)return[];let g=r?"x":"y",P=n.obstacleOptions.margin,v={soft:{xMin:l,xMax:x,yMin:M,yMax:d},hard:n.hardBounds};return(c=O(p,e))>-1?(h=E(c=p[c],e,i,r,v),w(c,n.hardBounds),u=r?{y:e.y,x:c[h?"xMax":"xMin"]+(h?1:-1)}:{x:e.x,y:c[h?"yMax":"yMin"]+(h?1:-1)},(f=O(p,u))>-1&&(w(f=p[f],n.hardBounds),u[g]=h?b(c[g+"Max"]-P+1,(f[g+"Min"]+c[g+"Max"])/2):m(c[g+"Min"]+P-1,(f[g+"Max"]+c[g+"Min"])/2),e.x===u.x&&e.y===u.y?(y&&(u[g]=h?b(c[g+"Max"],f[g+"Max"])+1:m(c[g+"Min"],f[g+"Min"])-1),y=!y):y=!1),o=[{start:e,end:u}]):(a=A(e,{x:r?i.x:e.x,y:r?e.y:i.y},r),o=[{start:e,end:{x:a.x,y:a.y}}],a[r?"x":"y"]!==i[r?"x":"y"]&&(h=E(a.obstacle,a,i,!r,v),w(a.obstacle,n.hardBounds),s={x:r?a.x:a.obstacle[h?"xMax":"xMin"]+(h?1:-1),y:r?a.obstacle[h?"yMax":"yMin"]+(h?1:-1):a.y},r=!r,o=o.concat(t({x:a.x,y:a.y},s,r)))),o.concat(t(o[o.length-1].end,i,!r))}(t,e,o)).concat(h.reverse())),obstacles:i}}A.requiresObstacles=!0,E.requiresObstacles=!0;let I={connectors:{type:"straight",radius:0,lineWidth:1,marker:{enabled:!1,align:"center",verticalAlign:"middle",inside:!1,lineWidth:1},startMarker:{symbol:"diamond"},endMarker:{symbol:"arrow-filled"}}},{setOptions:L}=h(),{defined:R,error:B,merge:C}=h();function W(t){let e=t.shapeArgs;if(e)return{xMin:e.x||0,xMax:(e.x||0)+(e.width||0),yMin:e.y||0,yMax:(e.y||0)+(e.height||0)};let n=t.graphic&&t.graphic.getBBox();return n?{xMin:t.plotX-n.width/2,xMax:t.plotX+n.width/2,yMin:t.plotY-n.height/2,yMax:t.plotY+n.height/2}:null}!function(t){function e(t){let e,n,i=W(this);switch(t.align){case"right":e="xMax";break;case"left":e="xMin"}switch(t.verticalAlign){case"top":n="yMin";break;case"bottom":n="yMax"}return{x:e?i[e]:(i.xMin+i.xMax)/2,y:n?i[n]:(i.yMin+i.yMax)/2}}function n(t,e){let n;return!R(e)&&(n=W(this))&&(e={x:(n.xMin+n.xMax)/2,y:(n.yMin+n.yMax)/2}),Math.atan2(e.y-t.y,t.x-e.x)}function i(t,e,n){let i=2*Math.PI,r=W(this),a=r.xMax-r.xMin,o=r.yMax-r.yMin,s=Math.atan2(o,a),h=a/2,c=o/2,l=r.xMin+h,x=r.yMin+c,M={x:l,y:x},d=t,y=1,p=!1,f=1,u=1;for(;d<-Math.PI;)d+=i;for(;d>Math.PI;)d-=i;return y=Math.tan(d),d>-s&&d<=s?(u=-1,p=!0):d>s&&d<=Math.PI-s?u=-1:d>Math.PI-s||d<=-(Math.PI-s)?(f=-1,p=!0):f=-1,p?(M.x+=f*h,M.y+=u*h*y):(M.x+=o/(2*y)*f,M.y+=u*c),n.x!==l&&(M.x=n.x),n.y!==x&&(M.y=n.y),{x:M.x+e*Math.cos(d),y:M.y-e*Math.sin(d)}}t.compose=function(t,r,a){let o=a.prototype;o.getPathfinderAnchorPoint||(t.prototype.callbacks.push(function(t){!1!==t.options.connectors.enabled&&((t.options.pathfinder||t.series.reduce(function(t,e){return e.options&&C(!0,e.options.connectors=e.options.connectors||{},e.options.pathfinder),t||e.options&&e.options.pathfinder},!1))&&(C(!0,t.options.connectors=t.options.connectors||{},t.options.pathfinder),B('WARNING: Pathfinder options have been renamed. Use "chart.connectors" or "series.connectors" instead.')),this.pathfinder=new r(this),this.pathfinder.update(!0))}),o.getMarkerVector=i,o.getPathfinderAnchorPoint=e,o.getRadiansToVector=n,L(I))}}(n||(n={}));let j=n;var X=a(260),_=a.n(X);let{addEvent:D,defined:H,pick:S,splat:V}=h(),Y=Math.max,q=Math.min;class G{static compose(t,e){j.compose(t,G,e)}constructor(t){this.init(t)}init(t){this.chart=t,this.connections=[],D(t,"redraw",function(){this.pathfinder.update()})}update(t){let e=this.chart,n=this,i=n.connections;n.connections=[],e.series.forEach(function(t){t.visible&&!t.options.isInternal&&t.points.forEach(function(t){let i,r=t.options;r&&r.dependency&&(r.connect=r.dependency);let a=t.options?.connect?V(t.options.connect):[];t.visible&&!1!==t.isInside&&a.forEach(r=>{let a="string"==typeof r?r:r.to;a&&(i=e.get(a)),i instanceof _()&&i.series.visible&&i.visible&&!1!==i.isInside&&n.connections.push(new f(t,i,"string"==typeof r?{}:r))})})});for(let t,e,r=0,a=i.length,o=n.connections.length;r<a;++r){e=!1;let a=i[r];for(t=0;t<o;++t){let i=n.connections[t];if((a.options&&a.options.type)===(i.options&&i.options.type)&&a.fromPoint===i.fromPoint&&a.toPoint===i.toPoint){i.graphics=a.graphics,e=!0;break}}e||a.destroy()}delete this.chartObstacles,delete this.lineObstacles,n.renderConnections(t)}renderConnections(t){t?this.chart.series.forEach(function(t){let e=function(){let e=t.chart.pathfinder;(e&&e.connections||[]).forEach(function(e){e.fromPoint&&e.fromPoint.series===t&&e.render()}),t.pathfinderRemoveRenderEvent&&(t.pathfinderRemoveRenderEvent(),delete t.pathfinderRemoveRenderEvent)};!1===t.options.animation?e():t.pathfinderRemoveRenderEvent=D(t,"afterAnimate",e)}):this.connections.forEach(function(t){t.render()})}getChartObstacles(t){let e,n=this.chart.series,i=S(t.algorithmMargin,0),r=[];for(let t=0,e=n.length;t<e;++t)if(n[t].visible&&!n[t].options.isInternal)for(let e,a,o=0,s=n[t].points.length;o<s;++o)(a=n[t].points[o]).visible&&(e=function(t){let e=t.shapeArgs;if(e)return{xMin:e.x||0,xMax:(e.x||0)+(e.width||0),yMin:e.y||0,yMax:(e.y||0)+(e.height||0)};let n=t.graphic&&t.graphic.getBBox();return n?{xMin:t.plotX-n.width/2,xMax:t.plotX+n.width/2,yMin:t.plotY-n.height/2,yMax:t.plotY+n.height/2}:null}(a))&&r.push({xMin:e.xMin-i,xMax:e.xMax+i,yMin:e.yMin-i,yMax:e.yMax+i});return r=r.sort(function(t,e){return t.xMin-e.xMin}),H(t.algorithmMargin)||(e=t.algorithmMargin=function(t){let e,n=t.length,i=[];for(let r=0;r<n;++r)for(let a=r+1;a<n;++a)(e=function t(e,n,i){let r=S(i,10),a=e.yMax+r>n.yMin-r&&e.yMin-r<n.yMax+r,o=e.xMax+r>n.xMin-r&&e.xMin-r<n.xMax+r,s=a?e.xMin>n.xMax?e.xMin-n.xMax:n.xMin-e.xMax:1/0,h=o?e.yMin>n.yMax?e.yMin-n.yMax:n.yMin-e.yMax:1/0;return o&&a?r?t(e,n,Math.floor(r/2)):1/0:q(s,h)}(t[r],t[a]))<80&&i.push(e);return i.push(80),Y(Math.floor(i.sort(function(t,e){return t-e})[Math.floor(i.length/10)]/2-1),1)}(r),r.forEach(function(t){t.xMin-=e,t.xMax+=e,t.yMin-=e,t.yMax+=e})),r}getObstacleMetrics(t){let e,n,i=0,r=0,a=t.length;for(;a--;)e=t[a].xMax-t[a].xMin,n=t[a].yMax-t[a].yMin,i<e&&(i=e),r<n&&(r=n);return{maxHeight:r,maxWidth:i}}getAlgorithmStartDirection(t){let e="left"!==t.align&&"right"!==t.align,n="top"!==t.verticalAlign&&"bottom"!==t.verticalAlign;return e?!!n&&void 0:!!n||void 0}}function T(t,e,n,i){return[["M",t,e+i/2],["L",t+n,e],["L",t,e+i/2],["L",t+n,e+i]]}function z(t,e,n,i){return T(t,e,n/2,i)}function N(t,e,n,i){return[["M",t+n,e],["L",t,e+i/2],["L",t+n,e+i],["Z"]]}function U(t,e,n,i){return N(t,e,n/2,i)}G.prototype.algorithms={fastAvoid:E,straight:function(t,e){return{path:[["M",t.x,t.y],["L",e.x,e.y]],obstacles:[{start:t,end:e}]}},simpleConnect:A};let Z=h();Z.Pathfinder=Z.Pathfinder||G,function(t){let e=t.prototype.symbols;e.arrow=T,e["arrow-filled"]=N,e["arrow-filled-half"]=U,e["arrow-half"]=z,e["triangle-left"]=N,e["triangle-left-half"]=U}(Z.SVGRenderer),Z.Pathfinder.compose(Z.Chart,Z.Point);let F=h();return o.default})())(r._Highcharts,r._Highcharts.Point)),o=e({__proto__:null,default:t(a)},[a]);export{o as p};
//# sourceMappingURL=pathfinder-CsQwimsl.js.map
